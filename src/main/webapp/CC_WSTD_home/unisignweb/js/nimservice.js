var __nimservice=function(k){function m(a,b,c){var f=JSON.parse(a),e={};e.messageNumber=b;e.operation=f.operation;e.callback=c;e.valid=!0;10<=y&&(y=0);s[y]=e;y+=1;h+=1;try{document.getElementById("hsmiframe").contentWindow.postMessage(a,u)}catch(d){null!=c&&c(-1)}}function r(){return"touchen"==k.ESVS.SecureKeyboardType&&k.bsUtil().isTouchEnKeyUsable()?1:"ahnlab"==k.ESVS.SecureKeyboardType&&k.bsUtil().isAhnlabProtectorUsable()?2:0}function n(a){return 0==r()?k.bsUtil().GetEnvelopedPwd(a):a}function G(a){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[0],manager:"ccsign"}),h,a)}function J(a,b,c,e,d){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[7],manager:"ccsign",version:a,siteInfo:b,securityInfo:c,downloadURL:e}),h,d)}function H(a,b,c,e,d,q,g){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[9],manager:"ccsign",sitecode:a,modcode:b,siteURL:c,serviceIP:e,servicePort:d,downloadURL:q}),h,g)}function L(a,b){if(0!=a.resultCode)e=a.resultCode,d=a.resultMessage,b(e,d);else if(a.disklist){var c=eval(a.disklist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function M(a,b){if(0!=a.resultCode)e=a.resultCode,d=a.resultMessage,b(e,d);else if(a.hsmlist){var c=eval(a.hsmlist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function D(a,b,c,e){a={messageNumber:h,sessionID:""+l,operation:f[42],manager:"ccsign",pki:k.ESVS.PKI,lang:"ko_kr"==k.ESVS.Language?0:1,device:a,drive:b,pin:n(c),options:{seckeyboard:r()}};m(JSON.stringify(a),h,e)}function E(a,b){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[43],manager:"ccsign",index:a,includeCertPath:1}),h,b)}function I(a,b,c,e,d,q,g,z,k,s,N){a={messageNumber:h,sessionID:""+l,operation:f[24],manager:"ccsign",index:a,pwd:n(b),input:{inputdata:{plaintype:c,hashalg:e,authattr:s,plaintext:d}},inCon:!0==g?1:0,charset:q,kmcert:z,multiuse:!0==k?1:0,options:{seckeyboard:r()}};m(JSON.stringify(a),h,N)}function O(a,b){if(0!=a.resultCode)e=a.resultCode,d=a.resultMessage,b(e,d);else if(a.hsmlist){var c=eval(a.disklist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function P(a,b){if(0!=a.resultCode)e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage);else if(a.disklist){var c=eval(a.disklist);b(a.resultCode,a.resultMessage,c)}else b(a.resultCode,a.resultMessage,"")}function x(a){return 1*a.replace(/\./g,"")}function A(a){var b=0;switch(a){case 0:for(b=0;b<s.length;b++)if(s[b].operation==f[42]||s[b].operation==f[43])s[b].valid=!1;break;case 1:for(b=0;b<s.length;b++)s[b].operation==f[43]&&(s[b].valid=!1)}}var h=0,B=Math.random(),w=Math.pow(10,28),l=Math.round(B*w)/w,f="GetVersion InitUniSignWebToolkit GetLastErrorCode GetLastErrorMessage GetCertForKeyboardEncrypt SetSecureField GetDiskList SetMobileOptions GetHSMList SetUSIMOptions IsInstalledUSIMModule ClearAllUserCertList CopyCert DeleteCert ChangePassword ImportCert ExportCert GetPfxCertList VerifyCertificate GetCACertificates CheckPassword CheckSCardConnected CheckSCardPin GetSignDataP1 GetSignDataP7 VerifyP1SignData VerifySignedData GetSignFileP7 VerifyVID ExportCertEx ImportCertEx MakeHash EnvelopData DeEnvelopData EncryptData EncryptDataWithSymmKey DecryptDataWithSymmKey MakeXMLDSIG IssueCertificate RenewCertificate RevokeCertificate IssueKMCertificate GetAllUserCertListNum GetSignCertFromCertList VerifySignedFile CheckPasswdCombination CheckNewPasswdCombination GetBackupedDriveList BackupToUSB GetBackupedSlot RecoverFromUSB GetSDList IsSDInstalled GetMacAddress GetBackupedCertList CheckConnectToCAServer SetSystemTimeFromTimeServer IsUBIkeyInstalled GetRValueFromKey GetCertPath".split(" "),Q={device:2,name:"PKCS#11 TOKEN"},v=!1,C=null,e="",d="",R=k.nimVersion,y=0,s=[],u="https://127.0.0.1:15018",B=0,w=function(a){if(a.origin==u&&(v=!0,!(null==a.data||0>=a.data.length))){var b=0,c=null;a=JSON.parse(a.data);for(b=0;b<s.length;b++)if("object"===typeof s[b]&&s[b].messageNumber==a.messageNumber){if(!1==s[b].valid)return;c=s[b].callback;s[b]=0;break}268500992==a.resultCode&&(k.uiUtil().msgBox(k.uiUtil().getErrorMessageLang().IDS_MSGBOX_LOCALSERVER_UNLOAD),k.ActiveUI.dispose());if("ccsign"==a.manager||"ccmanager"==a.manager||"ccmanager_exp"==a.manager)a.operation==f[0]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):(C=a.version,c=C.split("."),C=c[0]+"."+c[1]+"."+c[2]+".0",b(a.resultCode,a.resultMessage,a.version))):a.operation==f[1]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[4]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.pub)):a.operation==f[6]?L(a,c):a.operation==f[7]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[8]?M(a,c):a.operation==f[9]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[10]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[11]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[12]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[13]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[14]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[15]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[16]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(e,d)):b(a.resultCode,a.resultMessage,a.filepath)):a.operation==f[17]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage,a.index)):a.operation==f[18]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[19]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage,a.cacert,a.rootcert,a.rootcerthex)):a.operation==f[20]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[21]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[22]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[23]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(e,d)):b(a.resultCode,a.resultMessage,a.signeddata,a.encRValue,a.cert,a.label)):a.operation==f[24]||a.operation==f[27]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(e,d)):b(a.resultCode,a.resultMessage,a.signeddata,a.encRValue,a.cert,a.label)):a.operation==f[25]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[26]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(e,d)):b(a.resultCode,a.resultMessage,a.plaintext)):a.operation==f[28]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[29]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.pfx)):a.operation==f[30]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[31]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.hashdata)):a.operation==f[32]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.envelopeddata)):a.operation==f[33]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.plaintext)):a.operation==f[34]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.encrypteddata)):a.operation==f[35]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.encrypteddata)):a.operation==f[36]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.plaintext)):a.operation==f[37]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(e,d)):b(a.resultCode,a.resultMessage,a.signeddata,a.encRValue,a.cert,a.label)):a.operation==f[38]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[39]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage,a.cert)):a.operation==f[40]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[41]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[42]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.certcnt)):a.operation==f[43]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.signcert,a.certPath)):a.operation==f[44]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.plaintext,a.signcert)):a.operation==f[45]||a.operation==f[46]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[47]?P(a,c):a.operation==f[48]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[49]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.slot)):a.operation==f[50]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[51]?O(a,c):a.operation==f[52]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[53]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.mac)):a.operation==f[54]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(a.resultCode,a.resultMessage)):b(a.resultCode,a.resultMessage,a.certlist)):a.operation==f[55]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[56]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[57]?(0!=a.resultCode&&(e=a.resultCode,d=a.resultMessage),c(a.resultCode,a.resultMessage)):a.operation==f[58]?(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(e,d)):b(a.resultCode,a.resultMessage,a.RValue)):a.operation==f[59]&&(b=c,0!=a.resultCode?(e=a.resultCode,d=a.resultMessage,b(e,d)):b(a.resultCode,a.resultMessage,a.certPath))}},F=function(a){v=!1;var b=!0,c=function(c,e){if(b)if(b=!1,c&&c.parentNode&&c.parentNode.removeChild(c),e){if(!k.ESVS.chkEXESetup){document.getElementById("hsmiframe").src="about:blank";document.getElementById("hsmiframe").src=u;k.ESVS.chkEXESetup=!0;var d=document.getElementsByClassName("us-download-select").length;if(0<d)for(d-=1;0<=d;d--)document.getElementsByClassName("us-download-select")[d].parentNode.removeChild(document.getElementsByClassName("us-download-select")[d])}setTimeout(function(){G(function(b,c,d){if("0"==b||0==b){b=d.split(".");b=b[0]+"."+b[1]+"."+b[2]+".0";a:{c=b;b=R.split(".");c=c.split(".");len=3;for(d=0;d<len;d++)if(b[d]&&!c[d]&&0<x(b[d])||x(b[d])>x(c[d])){b=!0;break a}else if(c[d]&&!b[d]&&0<x(c[d])||x(b[d])<x(c[d])){b=!1;break a}b=!1}b?window.open(k.nimCheckUrl):(v=!0,a(e))}})},300)}else b=!0,v=e,k.ESVS.chkEXESetup=!1,a(e);else b=!0,v=e,k.ESVS.chkEXESetup=!1,a(e)},e;-1!=navigator.userAgent.indexOf("MSIE 7.0")?e=document.createElement("<img id='hsmImg' src='"+u+"/CRS?cd="+Math.random()+"' onload='' onerror='fnResult(this, false)' />"):(e=document.createElement("img"),e.setAttribute("id","hsmImg"),e.setAttribute("src",u+"/CRS?cd="+Math.random()));e.onerror=function(){c(e,!1)};e.onload=function(){c(e,!0)};e.style.display="none";document.body.appendChild(e);if(-1!=navigator.userAgent.indexOf("MSIE 8")){var d=function(){!1==v?setTimeout(d,100):c(null,!0)};setTimeout(d,100)}};0<B&&(B--,"function"===typeof window.addEventListener?window.removeEventListener("message",w,!1):window.detachEvent("onmessage",w));"function"===typeof window.addEventListener?window.addEventListener("message",w,!1):window.attachEvent("onmessage",w);B++;var g=function(a,b){if(-1!=b){var c=document.getElementById("us-div-cert-list-load");null!=c?k.uiUtil().loadingBox(!0,"us-div-cert-list-load",b):(c=document.getElementById("us-div-list-load"),k.uiUtil().loadingBox(!0,"us-div-list-load",b))}F(function(b){if(b)a();else if(confirm(k.uiUtil().getErrorMessageLang().IDS_ERROR_NIM_NOT_INSTALL_CFM)){window.open(k.nimCheckUrl);var c=function(b){b?a():k.ESVS._chkEXESetupCancel||setTimeout(function(){F(c)},1500)};k.ESVS._chkEXESetupCancel||setTimeout(function(){F(c)},1500)}})};return{GetLastErrorCode:function(){return e},GetLastErrorMessage:function(){return d},GetVersion:function(a){g(function(){null==C?G(a):a(0,"",C)},-1)},IsAvailable:function(){return v},InitUniSignWebToolkit:function(a,b,c){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[1],manager:"ccsign",pki:k.ESVS.PKI,lang:"ko_kr"==k.ESVS.Language?0:1,domain:a,license:b}),h,c)},13)},GetCertForKeyboardEncrypt:function(a,b,c){g(function(){e=-1;d="";var p={messageNumber:h,sessionID:""+l,operation:f[4],manager:"ccsign",domain:a,license:b,options:{seckeyboard:r()}};m(JSON.stringify(p),h,c)})},SetUSIMOptions:function(a,b,c,f,h,q,l){g(function(){e=-1;d="";H(a,b,c,f,h,q,l)},14)},GetDiskList:function(a){g(function(){A(0);e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[6],manager:"ccsign"}),h,a)},14)},GetHSMList:function(a,b){g(function(){A(0);e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[8],manager:"ccsign",listtype:a}),h,b)},14)},IsInstalledUSIMModule:function(a,b,c){g(function(){A(0);e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[10],manager:"ccsign",vendor:a,checkonly:!0==b?1:0}),h,c)},14)},IssueCertificate:function(a,b,c,p,t,q,k,z,s,u){g(function(){e=-1;d="";var g=s;k==Q&&(g=pwd);g={messageNumber:h,sessionID:""+l,operation:f[38],manager:"ccsign",ip:a,port:b,refnum:c,authcode:p,newpwd:n(t),newrepwd:n(q),device:k,drive:z,pin:n(g),options:{seckeyboard:r()}};m(JSON.stringify(g),h,u)},15)},IssueKMCertificate:function(a,b,c,p,t){g(function(){e=-1;d="";var q={messageNumber:h,sessionID:""+l,operation:f[41],manager:"ccsign",ip:a,port:b,index:c,pwd:n(p),options:{seckeyboard:r()}};m(JSON.stringify(q),h,t)},15)},RenewCertificate:function(a,b,c,p,t,q,k,z){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[39],manager:"ccsign",ip:a,port:b,index:c,newpwd:n(p),newrepwd:n(t),oldpwd:n(q),multiuse:!0==k?1:0,options:{seckeyboard:r()}};m(JSON.stringify(g),h,z)},4)},RevokeCertificate:function(a,b,c,p,t,q,k){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[40],manager:"ccsign",ip:a,port:b,index:c,pwd:n(p),reason:t,deletecert:q,options:{seckeyboard:r()}};m(JSON.stringify(g),h,k)},4)},GetAllUserCertListNum:function(a,b,c,f){g(function(){A(0);e=-1;d="";4==a?J(k.ubiKeyEnv.version,k.ubiKeyEnv.siteInfo,k.ubiKeyEnv.securityInfo,k.ubiKeyEnv.downloadURL,function(d){0==d?D(a,b,c,f):f(d,0)}):6==a?H(k.usimEnv.sitecode,k.usimEnv.modecode,k.usimEnv.siteURL,k.usimEnv.serviceIP,k.usimEnv.servicePort,k.usimEnv.downloadURL,function(d){0==d?D(a,b,c,f):f(d,0)}):D(a,b,c,f)},0)},GetAllUserCert:function(a,b){g(function(){function c(f,h,g,l){if(0==f)null!=g&&0<g.length&&(f={},f.index=d+1,f.cert=g,f.path=l,e[d]=f);else return b(f),!1;if(a==e.length)return __callback=null,b(0,e),!0;d+=1;E(d+1,c)}A(1);var d=0,e=[];E(d+1,c)},0)},ClearAllUserCertList:function(a){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[11],manager:"ccsign"}),h,a)},0)},GetSignCertFromCertList:function(a,b){g(function(){e=-1;d="";E(a,b)},0)},CheckPassword:function(a,b,c,p,t){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[20],manager:"ccsign",index:c,device:a,drive:b,pwd:n(p),options:{seckeyboard:r()}};m(JSON.stringify(g),h,t)},9)},CheckSCardConnected:function(a){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[21],manager:"ccsign"}),h,a)},9)},CheckSCardPin:function(a,b){g(function(){e=-1;d="";var c={messageNumber:h,sessionID:""+l,operation:f[22],manager:"ccsign",pin:n(a),options:{seckeyboard:r()}};m(JSON.stringify(c),h,b)},9)},GetPfxCertList:function(a,b,c,p){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[17],manager:"ccsign",input:{inputtype:a,inputdata:b},pwd:n(c),options:{seckeyboard:r()}};m(JSON.stringify(g),h,p)},0)},VerifyCertificate:function(a,b,c){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[18],manager:"ccsign",index:a,verifytype:b}),h,c)},12)},GetCACertificates:function(a,b){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[19],manager:"ccsign",index:a}),h,b)},-1)},GetSignDataP7:function(a,b,c,f,h,l,m,k){g(function(){e=-1;d="";I(a,b,0,"",c,f,h,l,m,!1,k)},1)},GetSignDataP7WithHash:function(a,b,c,f,h,l,m,k,n,r){g(function(){e=-1;d="";I(a,b,1,c,f,h,l,m,k,n,r)},1)},GetSignDataP1:function(a,b,c,p,k,q){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[23],manager:"ccsign",index:a,pwd:n(b),plaintext:c,kmcert:p,multiuse:!0==k?1:0,options:{seckeyboard:r()}};m(JSON.stringify(g),h,q)},1)},VerifySignedData:function(a,b,c){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[26],manager:"ccsign",signeddata:b,plaintext:a}),h,c)},16)},VerifyP1SignData:function(a,b,c,p){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[25],manager:"ccsign",plaintext:a,signeddata:b,cert:c}),h,p)},16)},GetSignFileP7:function(a,b,c,p,k,q){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[27],manager:"ccsign",index:a,pwd:n(b),input:{inputdata:c[0],rewrite:c[3]},inCon:!0==p?1:0,rettype:c[1],outfilepath:c[2],kmcert:k,options:{seckeyboard:r()}};m(JSON.stringify(g),h,q)},1)},DeleteCert:function(a,b,c){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[13],manager:"ccmanager",index:a,pwd:n(b),options:{seckeyboard:r()}};m(JSON.stringify(g),h,c)},3)},ImportCert:function(a,b,c,p,k,q,K){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[15],manager:"ccmanager",input:{inputtype:a,inputdata:b},pwd:n(c),device:p,drive:k,pin:n(q),options:{seckeyboard:r()}};m(JSON.stringify(g),h,K)},6)},ExportCert:function(a,b,c){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[16],manager:"ccmanager_exp",index:a,pwd:n(b),options:{seckeyboard:r()}};m(JSON.stringify(g),h,c)},7)},CopyCert:function(a,b,c,p,k,q){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[12],manager:"ccmanager",index:a,pwd:n(b),device:c,drive:p,pin:n(k),options:{seckeyboard:r()}};m(JSON.stringify(g),h,q)},5)},ChangePassword:function(a,b,c,p){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[14],manager:"ccmanager",index:a,pwd:n(b),newpwd:n(c),options:{seckeyboard:r()}};m(JSON.stringify(g),h,p)},8)},VerifyVID:function(a,b,c,p,t){g(function(){e=-1;var g=d="",g=0==c?k.bsUtil().GetEnvelopedPwd(p):n(p),g={userin:c,ssn:g},g={messageNumber:h,sessionID:""+l,operation:f[28],manager:"ccsign",index:a,pwd:n(b),ssn:g,multiuse:!0==k.ESVS.multiuse?1:0,options:{seckeyboard:r()}};m(JSON.stringify(g),h,t)},12)},VerifySignedFile:function(a,b,c,p,k,q){g(function(){e=-1;d="";var g=0;null!=a&&(g=1);var n="",n=0==g?{messageNumber:h,sessionID:""+l,operation:f[44],manager:"ccsign",signtype:g,signdatatype:b,signeddata:c,rettype:p,outfilepath:k}:{messageNumber:h,sessionID:""+l,operation:f[44],manager:"ccsign",signtype:g,plaintext:a,signdatatype:b,signeddata:c,rettype:p,outfilepath:k};m(JSON.stringify(n),h,q)})},EnvelopData:function(a,b,c,p,k,q,s){g(function(){e=-1;d="";var g=1;"kmcert"==a&&(g=2);g={messageNumber:h,sessionID:""+l,operation:f[32],manager:"ccsign",certtype:g,index:b,pwd:n(c),kmcert:p,plaintext:k,multiuse:!0==q?1:0,options:{seckeyboard:r()}};m(JSON.stringify(g),h,s)},10)},DeEnvelopData:function(a,b,c,p,k){g(function(){e=-1;d="";var g=1;"kmcert"==a&&(g=2);g={messageNumber:h,sessionID:""+l,operation:f[33],manager:"ccsign",certtype:g,index:b,pwd:n(c),envelopeddata:p,options:{seckeyboard:r()}};m(JSON.stringify(g),h,k)},11)},ExportCertEx:function(a,b,c,p,k,q){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[29],manager:"ccsign",device:a,drive:b,index:c,pfxpwd:p,pwd:n(k),options:{seckeyboard:r()}};m(JSON.stringify(g),h,q)},7)},ImportCertEx:function(a,b,c,k,t,q,s){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[30],manager:"ccsign",device:a,drive:b,pin:n(c),pwd:n(k),pfx:t,pfxpwd:q,options:{seckeyboard:r()}};m(JSON.stringify(g),h,s)},6)},CheckPasswdCombination:function(a,b,c,k,t){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[45],manager:"ccsign",pwd:n(a),pwdmin:b,pwdmax:c,pwdlevel:k,options:{seckeyboard:r()}};m(JSON.stringify(g),h,t)},8)},CheckNewPasswdCombination:function(a,b,c,k,t,q){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[46],manager:"ccsign",newpwd:n(a),newrepwd:n(b),pwdmin:c,pwdmax:k,pwdlevel:t,options:{seckeyboard:r()}};m(JSON.stringify(g),h,q)},8)},GetBackupedDriveList:function(a){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[47],manager:"ccsign"}),h,a)},14)},BackupToUSB:function(a,b,c,k){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[48],manager:"ccsign",index:a,drive:b,pwd:n(c),options:{seckeyboard:r()}};m(JSON.stringify(g),h,k)},17)},GetBackupedSlot:function(a,b){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[49],manager:"ccsign",drive:a}),h,b)},17)},GetBackupedCertList:function(a,b){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[54],manager:"ccsign",drive:a}),h,b)},0)},RecoverFromUSB:function(a,b,c,k){g(function(){e=-1;d="";var g={messageNumber:h,sessionID:""+l,operation:f[50],manager:"ccsign",drive:a,index:b,pwd:n(c),options:{seckeyboard:r()}};m(JSON.stringify(g),h,k)},18)},GetSDList:function(a){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[51],manager:"ccsign"}),h,a)},14)},IsSDInstalled:function(a){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[52],manager:"ccsign"}),h,a)},14)},MakeHash:function(a,b,c,k){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[31],manager:"ccsign",inputtype:a,inputdata:b,hashalg:c}),h,k)},19)},EncryptData:function(a,b){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[34],manager:"ccsign",plaintext:a}),h,b)},20)},EncryptDataWithSymmKey:function(a,b,c,k,n){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[35],manager:"ccsign",alg:a,symmkey:b,charset:k,plaintext:c}),h,n)},20)},DecryptDataWithSymmKey:function(a,b,c,k,n,q){g(function(){e=-1;d="";m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[36],manager:"ccsign",alg:a,symmkey:b,fromcharset:k,charset:n,encrypteddata:c}),h,q)},20)},GetMacAddress:function(a,b){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[53],manager:"ccsign",mode:a}),h,b)})},MakeXMLDSIG:function(a,b,c,d,e,k){g(function(){var g={messageNumber:h,sessionID:""+l,operation:f[37],manager:"ccsign",index:a,pwd:n(b),inCon:0,plaintext:c,kmcert:d,multiuse:e,options:{seckeyboard:r()}};m(JSON.stringify(g),h,k)},1)},GetRValueFromKey:function(a,b,c){g(function(){var d={messageNumber:h,sessionID:""+l,operation:f[58],manager:"ccsign",index:a,pwd:n(b),options:{seckeyboard:r()}};m(JSON.stringify(d),h,c)},1)},GetCertPath:function(a,b){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[59],manager:"ccsign",index:a}),h,b)},1)},CheckConnectToCAServer:function(a,b,c,d,e){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[55],manager:"ccmanager",ip:a,port:b,dirip:c,dirport:d}),h,e)},1)},SetSystemTimeFromTimeServer:function(a,b,c){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[56],manager:"ccmanager",ip:a,port:b}),h,c)},1)},IsUBIkeyInstalled:function(a){g(function(){m(JSON.stringify({messageNumber:h,sessionID:""+l,operation:f[57],manager:"ccmanager"}),h,a)},14)},checkInstall:function(a){var b=!0,c=function(c,d){if(b)if(b=!1,c&&c.parentNode&&c.parentNode.removeChild(c),d){if(!k.ESVS.chkEXESetup){document.getElementById("hsmiframe").src="about:blank";document.getElementById("hsmiframe").src=u;k.ESVS.chkEXESetup=!0;var e=document.getElementsByClassName("us-download-select").length;if(0<e)for(e-=1;0<=e;e--)document.getElementsByClassName("us-download-select")[e].parentNode.removeChild(document.getElementsByClassName("us-download-select")[e])}}else k.ESVS.chkEXESetup=!1,a(d);else k.ESVS.chkEXESetup=!1,a(d)},d;-1!=navigator.userAgent.indexOf("MSIE 7.0")?d=document.createElement("<img id='hsmImg' src='"+u+"/CRS?cd="+Math.random()+"' onload='' onerror='fnResult(this, false)' />"):(d=document.createElement("img"),d.setAttribute("id","hsmImg"),d.setAttribute("src",u+"/CRS?cd="+Math.random()));d.onerror=function(){c(d,!1)};d.onload=function(){c(d,!0)};d.style.display="none";document.body.appendChild(d);if(-1!=navigator.userAgent.indexOf("MSIE 8")){var e=function(){!1==v?setTimeout(e,100):c(null,!0)};setTimeout(e,100)}}}};