var __certverify=function(c){var n=function(g){function m(d,a,f){if(!d||!a)return null;var b=null;if(4==c.ESVS.Mode)if(c.nimservice())c.nimservice().VerifyCertificate(d,1,function(d,e){if(0==d)b=a.IDS_VERIFY_CERT_OK;else if("MPKI"!=c.ESVS.PKI)switch(d){case 3001:b=a.IDS_VERIFY_CERT_ERROR_INVALID_TYPE;break;case 3002:b=a.IDS_VERIFY_CERT_ERROR_DECODING_FAIL;break;case 3003:b=a.IDS_VERIFY_CERT_ERROR_LOADING_FAIL;break;case 3005:b=a.IDS_VERIFY_CERT_ERROR_EXPIRED;break;case 3009:b=a.IDS_VERIFY_CERT_ERROR_NO_DP;break;case 3010:b=a.IDS_VERIFY_CERT_ERROR_WRONG_DP;break;case 3013:b=a.IDS_VERIFY_CERT_ERROR_WRONG_CRL+"<br><br>Code [ "+d+" ]";break;case 3014:b=a.IDS_VERIFY_CERT_ERROR_EXPIRED_CRL;break;case 3015:b=a.IDS_VERIFY_CERT_ERROR_WRONG_CRL+"<br><br>Code [ "+d+" ]";break;case 3016:b=a.IDS_VERIFY_CERT_ERROR_HOLDED+"<br><br>Code [ "+d+" ]";break;case 3017:b=a.IDS_VERIFY_CERT_ERROR_REVOKED+"<br><br>Code [ "+d+" ]";break;case 3059:b=a.IDS_VERIFY_CERT_ERROR_GETTING_CRL_FROM_LDAP_FAIL;break;case 3060:b=a.IDS_VERIFY_CERT_ERROR_CHECKING_ISSUER_FAIL;break;case 3062:b=a.IDS_VERIFY_CERT_ERROR_CA_CERT_PATH;break;case 3063:b=a.IDS_VERIFY_CERT_ERROR_ROOTCA_CERT_PATH;break;case 3900:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_UNSUPERSEDED;break;case 3901:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_KEYCOMPROMISE;break;case 3902:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_CACOMPROMISE;break;case 3903:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_AFFILIATIONCHANGED;break;case 3904:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_SUPERSEDED;break;case 3905:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_CESSATIONOFOPERATION;break;case 3906:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_HOLD;break;case 3907:b=a.IDS_VERIFY_CERT_ERROR_REVOKED_REMOVEFROMCRL;break;case 3908:b=a.IDS_VERIFY_CERT_ERROR_REVOKED+"<br><br>Code [ "+d+" ]";break;case 3909:b=a.IDS_VERIFY_CERT_ERROR_REVOKED+"<br><br>Code [ "+d+" ]";break;case 3999:b=a.IDS_VERIFY_CERT_ERROR_REVOKED+"<br><br>Code [ "+d+" ]";break;default:b=a.IDS_VERIFY_CERT_ERROR_UNKNOWN+"<br><br>Code [ "+d+" ]"}else switch(d){case 3001:b=a.IDS_VERIFY_CERT_ERROR_INVALID_TYPE;break;case 3002:b=a.IDS_VERIFY_CERT_ERROR_DECODING_FAIL;break;case 3003:b=a.IDS_VERIFY_CERT_ERROR_LOADING_FAIL;break;case 3005:b=a.IDS_VERIFY_CERT_ERROR_EXPIRED;break;case 3009:b=a.IDS_VERIFY_CERT_ERROR_NO_DP;break;case 3010:b=a.IDS_VERIFY_CERT_ERROR_WRONG_DP;break;case 3013:b=a.IDS_VERIFY_CERT_ERROR_WRONG_CRL+"<br><br>Code [ "+d+" ]";break;case 3014:b=a.IDS_VERIFY_CERT_ERROR_EXPIRED_CRL;break;case 3015:b=a.IDS_VERIFY_CERT_ERROR_WRONG_CRL+"<br><br>Code [ "+d+" ]";break;case 3059:b=a.IDS_VERIFY_CERT_ERROR_GETTING_CRL_FROM_LDAP_FAIL;break;case 3060:b=a.IDS_VERIFY_CERT_ERROR_CHECKING_ISSUER_FAIL;break;case 3062:b=a.IDS_VERIFY_CERT_ERROR_CA_CERT_PATH;break;case 3063:b=a.IDS_VERIFY_CERT_ERROR_ROOTCA_CERT_PATH;break;case 3016:case 3017:case 3900:case 3901:case 3902:case 3903:case 3904:case 3905:case 3906:case 3907:case 3908:case 3909:case 3999:b=a.IDS_VERIFY_CERT_ERROR_REVOKED+"<br><br>Code [ "+d+" ]";break;case 4212E4:b=a.IDS_VERIFY_CERT_ERROR_EXPIRED+"<br>Code [ "+d+" ]";break;default:b=a.IDS_VERIFY_CERT_ERROR_UNKNOWN+"<br><br>Code [ "+d+" ]"}f(b)});else return c.uiUtil().msgBox(a.IDS_MSGBOX_NIM_ERROR_UNLOAD),b=null;else if(2&c.ESVS.Mode){var e=null;try{var l=c.usWebToolkit.pki.createCaStore(),e=c.PFSH.GetCACerts(),g;for(g in e)caCert=e[g],l.addCertificate(c.usWebToolkit.pki.certificateFromBase64(caCert));if(null==c.certsList||null==c.certsList.list||0>=c.certsList.list.length)return"";var h=c.usWebToolkit.pki.certificateFromBase64(c.certsList.list[d-1].cert);c.usWebToolkit.pki.verifyCertificateChain(l,h,function(d,c,e){!0===d?(result=0,b=a.IDS_VERIFY_CERT_OK):(result=-1,null!=e&&void 0!=e&&0<=e.indexOf("Certificate is not valid yet or has expired")?(errCode=3005,b=a.IDS_VERIFY_CERT_ERROR_EXPIRED):null!=e&&void 0!=e&&0<=e.indexOf("no parent issuer, so certificate not trusted")?(errCode=3060,b=a.IDS_VERIFY_CERT_ERROR_CHECKING_ISSUER_FAIL):(errCode=-1,b=e));f(b)})}catch(k){errCode=k.code,b=k.message,f(b)}}}function h(d){if(!d)return alert("UI load error."),!1;var a=document.createElement("div");document.body.insertBefore(a,document.body.firstChild);a.innerHTML=d;return!0}var e=function(){var d;d=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");d.open("GET",c.ESVS.SRCPath+"unisignweb/rsrc/layout/certverify.html?version="+c.ver,!1);d.send(null);return d.responseText},k=function(){var d;d=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");d.open("GET",c.ESVS.SRCPath+"unisignweb/rsrc/lang/"+c.ESVS.Language+"/certverify_"+c.ESVS.Language+".js?version="+c.ver,!1);d.send(null);return d.responseText},l=c.ESVS.TabIndex;return function(){var d=eval(e),a=eval(eval(k)()),f=g.args.idx;h(d());d=document.getElementById("us-cert-verify-lbl-title");d.appendChild(document.createTextNode(a.IDS_VERIFY_CERT));d.setAttribute("tabindex",l,0);var b=document.getElementById("us-cert-verify-lbl");4&c.ESVS.Mode||2&c.ESVS.Mode?m(f,a,function(a){a&&b&&(b.innerHTML=a,b.setAttribute("tabindex",l+1,0))}):(f=m(f,a))&&b&&(b.innerHTML=f,b.setAttribute("tabindex",l+1,0));f=document.getElementById("us-cert-verify-confirm-btn");f.setAttribute("value",a.IDS_CONFIRM,0);f.setAttribute("title",a.IDS_CONFIRM+a.IDS_BUTTON,0);f.setAttribute("tabindex",l+2,0);f.onclick=function(){g.onConfirm()};a=document.getElementById("us-cert-verify-cls-img-btn");a.setAttribute("tabindex",l+3,0);a.onclick=function(){g.onCancel()};document.getElementById("us-cert-verify-cls-btn-img").setAttribute("src",c.ESVS.SRCPath+"unisignweb/rsrc/img/x-btn.png",0);c.uiUtil().setRotationTabFocus(f,b,d);c.uiUtil().setRotationTabFocus(d,f,b);return document.getElementById("us-div-cert-verify")}()};return function(g){var m=c.uiLayerLevel,h=c.uiUtil().getOverlay(m),e=n({type:g.type,args:g.args,onConfirm:g.onConfirm,onCancel:g.onCancel});e.style.zIndex=m+1;c.ESVS.TargetObj.insertBefore(h,c.ESVS.TargetObj.firstChild);var k=window.onresize;return{show:function(){c.ActiveUI=this;draggable(e,document.getElementById("us-div-cert-verify-title"));h.style.display="block";c.uiUtil().offsetResize(e);window.onresize=function(){c.uiUtil().offsetResize(e);k&&k()};c.uiLayerLevel+=10;c.ESVS.TabIndex+=30;setTimeout(function(){var c=e.getElementsByTagName("p");if(0<c.length)for(var d=0;d<c.length;d++)"us-cert-verify-lbl-title"==c[d].id&&c[d].focus()},10)},hide:function(){h.style.display="none";e.style.display="none"},dispose:function(){window.onresize=function(){k&&k()};e.parentNode.parentNode.removeChild(e.parentNode);h.parentNode.removeChild(h);c.uiLayerLevel-=10;c.ESVS.TabIndex-=30}}}};